<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>TermometrOnline</title>
    <link rel="stylesheet" type="text/css" href="inicio.css" />
    <link rel="stylesheet" type="text/css" href="padroes.css" />
    <script type="text/javascript" src="eventos.js" charset="ISO-8859-1"></script>
	
</head>
<body>
    <div class="area" id="ar">
        <div class="menu">
            <div class="confs_usuario">
                <img src="../img/febre.jpg" class="foto_usuario" />
                <div>
                    <p class="nome_usuario">João Silva</p>
                    <p class="funcao_usuario">Usuário</p>
                </div>
            </div>
            <div class="sub_menus">
                <ul>
                    <li><a href="main.html" class="links">Início</a></li>
                    <li><a href="#" class="links">Relatórios de Temperatura</a></li>
                    <li><a href="#" class="links">Temperaturas Ideais</a></li>  
                    <li><a href="#" class="links" onclick="getViewConfiguracoes()">Configurações</a></li>                    
                </ul>
                <ul class="sair_site">
                    <li><a href="../index.html" class="links">Sair</a></li>
                </ul>
            </div>
        </div>

        <div class="pos_area_termo">
            <div id="area_termometro">
                <div class="termometro">
                    <p class="temperatura" id="txt_temperatura"></p>
                    <p class="ultima_att">11/02/2018 - 00:12</p>
                    <div class="reload" onclick="atualiza_numeros(document.getElementById('txt_temperatura').innerHTML.replace('°c', ''), Math.floor(Math.random() * 50)); atualiza_numeros_medias(document.getElementById('txt_temp_menor').innerHTML.replace('°c', ''),  Math.floor(Math.random() * 50), document.getElementById('txt_temp_media').innerHTML.replace('°c', ''),  Math.floor(Math.random() * 50), document.getElementById('txt_temp_maior').innerHTML.replace('°c', ''),  Math.floor(Math.random() * 50))"></div>
                </div>
                <div id="textos">
                    <!--<p id="desc_temp">Temperatura ideial para pegar câncer de pele</p>
                    <p id="desc_temp">Temperatura ideial para pegar câncer de pele</p>
                    <p id="desc_temp">Temperatura ideial para pegar câncer de pele</p>
                    <p id="desc_temp">Temperatura ideial para pegar câncer de pele</p>-->
                </div>
            </div>
        </div>
        <div class="medias_temperatura">
            <p id="titulo_medias">Médias de temperaturas do dia 17/02/2018</p>
            <div id="medias" class="">
                <p class="sub_titulos">Menor Temperatura</p>
                <p class="temperatura_medias" id="txt_temp_menor">10</p>
            </div>
            <div id="medias">
                <p class="sub_titulos">Temperatura Média</p>
                <p class="temperatura_medias" id="txt_temp_media">10</p>
            </div>
            <div id="medias">
                <p class="sub_titulos">Maior Temperatura</p>
                <p class="temperatura_medias" id="txt_temp_maior">10</p>
            </div>
        </div>
    </div>
    
    <audio id="alerta" loop>
        <source src="bythesword.mp3" type="audio/mp3" />
    </audio>

    <div id="fundo_modal" class="fundo_modal_off">
            <div id="tela_confs">
                <p class="titulo">Configurações</p>
                <a href="#" class="confs_opc" onclick="getViewAddArduino()">Adicionar Termometro</a>
                <a href="#" class="confs_opc">Editar suas Informações</a>
                <a href="#" class="confs_opc">Suporte</a>
                <a href="#" class="confs_opc">Ajuda</a>
                <a href="#" class="fechar" onclick="removerViewConfiguracoes()">x</a>
            </div>

            <div id='fundo_addArduino' class="fundo_addArduino_off">
                <div id='conf_arduino'>
                    <p class='titulo'>Adicionar novo Termometro</p>
                    <input type='text' name='' class='input_padrao' placeholder='Código do termometro'>
                    <input type='text' name='' class='input_padrao' placeholder='Nome de Exibição do Termometro'>
                    <input type='text' name='' class='term_input' placeholder='Temperatura Minima'>
                    <input type='text' name='' class='term_input' placeholder='Temperatura Maxima'>
                    <select>
                        <option value="null">Selecione o periodo de atualização</option>
                        <option value="10s">10 Segundos</option>
                        <option value="30s">30 Segundos</option>
                        <option value="1m">1 Minuto</option>
                        <option value="3m">3 Minuto</option>
                        <option value="5m">5 Minuto</option>
                    </select>
                    <button class='cnl'>Cancelar</button>
                    <button class='adc'>Adicionar</button>
                    <a href= '#' class='fechar' onclick='removerViewAddArduino()'>x</a>
                </div>
            </div>
        </div>

</body>

</html>
<script>

	function get_data(){
			var http = new XMLHttpRequest();
            http.open('GET', 'http://localhost:3000/api', false);
            http.send(null);        
			
            var obj = JSON.parse(http.responseText);

            if (obj.data.length == 0){
                return;
            }
			
			var _lastIndexTemp = this.lastIndexTemp;
            this.lastIndexTemp = obj.data.length;
            listTemp = obj.data.slice(_lastIndexTemp);
			
			document.getElementById('txt_temperatura').textContent = (int)obj.average
			console.log(obj.average);
			}
			
			get_data();
			
</script>